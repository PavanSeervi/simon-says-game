<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simon Says - Memory Challenge</title>

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        overflow-x: hidden;
      }

      .game-button {
        width: clamp(120px, 20vw, 200px);
        height: clamp(120px, 20vw, 200px);
        border-radius: 20px;
        border: none;
        transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        position: relative;
        overflow: hidden;
      }

      .game-button::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.3);
        opacity: 0;
        transition: opacity 0.15s;
      }

      .game-button:hover:not(.disabled) {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
      }

      .game-button:active:not(.disabled) {
        transform: scale(0.95);
      }

      .game-button.flash::before {
        opacity: 1;
      }

      .game-button.disabled {
        cursor: not-allowed;
        opacity: 0.6;
      }

      .btn-yellow {
        background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
      }
      .btn-red {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      }
      .btn-purple {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      }
      .btn-green {
        background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      }

      .game-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 30px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      .stat-badge {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        font-weight: 600;
      }

      .pulse {
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      .game-over-shake {
        animation: shake 0.5s;
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        10%,
        30%,
        50%,
        70%,
        90% {
          transform: translateX(-10px);
        }
        20%,
        40%,
        60%,
        80% {
          transform: translateX(10px);
        }
      }

      .fade-in {
        animation: fadeIn 0.5s;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .sound-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
      }
    </style>
  </head>

  <body>
    <div class="container py-4 py-md-5">
      <!-- Sound Toggle -->
      <button
        class="btn btn-light rounded-circle sound-toggle p-3 shadow"
        id="soundToggle"
        title="Toggle Sound"
      >
        <span id="soundIcon">üîä</span>
      </button>

      <!-- Welcome Screen -->
      <div id="welcomeScreen" class="text-center fade-in">
        <div class="game-card p-4 p-md-5 mx-auto" style="max-width: 700px">
          <h1
            class="display-3 fw-bold text-gradient mb-4"
            style="
              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
              -webkit-background-clip: text;
              -webkit-text-fill-color: transparent;
            "
          >
            Simon Says
          </h1>
          <p class="lead mb-4">
            Test your memory with this classic pattern game!
          </p>

          <div class="bg-light rounded-4 p-4 mb-4">
            <h5 class="fw-bold mb-3">How to Play:</h5>
            <ul class="list-unstyled text-start">
              <li class="mb-2">
                ‚ú® Watch the sequence of colored buttons light up
              </li>
              <li class="mb-2">
                üéØ Repeat the pattern by clicking the buttons in order
              </li>
              <li class="mb-2">üìà Each level adds one more step to remember</li>
              <li class="mb-2">üèÜ Keep going to beat your high score!</li>
            </ul>
          </div>

          <div
            class="d-flex flex-column flex-sm-row gap-3 justify-content-center align-items-center"
          >
            <button
              class="btn btn-lg btn-primary px-5 py-3 rounded-pill shadow pulse"
              id="startButton"
            >
              üéÆ Start Game
            </button>
            <div class="stat-badge px-4 py-2">
              <small>High Score</small>
              <div class="fs-4 fw-bold" id="highScoreDisplay">0</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Game Screen -->
      <div id="gameScreen" class="d-none">
        <div class="game-card p-4 mx-auto" style="max-width: 800px">
          <!-- Stats Row -->
          <div class="row g-3 mb-4 text-center">
            <div class="col-6 col-md-3">
              <div class="stat-badge p-3">
                <small class="d-block opacity-75">Level</small>
                <div class="fs-3 fw-bold" id="levelDisplay">1</div>
              </div>
            </div>
            <div class="col-6 col-md-3">
              <div class="stat-badge p-3">
                <small class="d-block opacity-75">Score</small>
                <div class="fs-3 fw-bold" id="scoreDisplay">0</div>
              </div>
            </div>
            <div class="col-6 col-md-3">
              <div class="stat-badge p-3">
                <small class="d-block opacity-75">High Score</small>
                <div class="fs-3 fw-bold" id="gameHighScore">0</div>
              </div>
            </div>
            <div class="col-6 col-md-3">
              <div class="stat-badge p-3">
                <small class="d-block opacity-75">Speed</small>
                <div class="fs-3 fw-bold" id="speedDisplay">1x</div>
              </div>
            </div>
          </div>

          <!-- Status Message -->
          <div class="text-center mb-4">
            <h3 class="h5 fw-bold" id="statusMessage">Watch carefully...</h3>
          </div>

          <!-- Game Buttons Grid -->
          <div class="row g-3 g-md-4 justify-content-center mb-4">
            <div class="col-6 d-flex justify-content-center">
              <button
                class="game-button btn-yellow shadow"
                data-color="yellow"
              ></button>
            </div>
            <div class="col-6 d-flex justify-content-center">
              <button
                class="game-button btn-red shadow"
                data-color="red"
              ></button>
            </div>
            <div class="col-6 d-flex justify-content-center">
              <button
                class="game-button btn-green shadow"
                data-color="green"
              ></button>
            </div>
            <div class="col-6 d-flex justify-content-center">
              <button
                class="game-button btn-purple shadow"
                data-color="purple"
              ></button>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="d-flex gap-2 justify-content-center">
            <button
              class="btn btn-outline-danger rounded-pill px-4"
              id="quitButton"
            >
              Quit Game
            </button>
          </div>
        </div>
      </div>

      <!-- Game Over Modal -->
      <div class="modal fade" id="gameOverModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content rounded-4 border-0 shadow-lg">
            <div class="modal-body text-center p-5">
              <div class="mb-4" id="gameOverEmoji" style="font-size: 5rem">
                üò¢
              </div>
              <h2 class="fw-bold mb-3" id="gameOverTitle">Game Over!</h2>
              <p class="lead mb-4" id="gameOverMessage">
                You reached level <span id="finalLevel">0</span>
              </p>
              <div class="bg-light rounded-4 p-4 mb-4">
                <div class="row g-3">
                  <div class="col-6">
                    <small class="d-block text-muted">Your Score</small>
                    <div class="fs-3 fw-bold" id="finalScore">0</div>
                  </div>
                  <div class="col-6">
                    <small class="d-block text-muted">High Score</small>
                    <div class="fs-3 fw-bold" id="modalHighScore">0</div>
                  </div>
                </div>
              </div>
              <div class="d-flex gap-2 justify-content-center">
                <button
                  class="btn btn-primary rounded-pill px-4 py-2"
                  id="playAgainButton"
                >
                  üîÑ Play Again
                </button>
                <button
                  class="btn btn-outline-secondary rounded-pill px-4 py-2"
                  data-bs-dismiss="modal"
                >
                  Back to Menu
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <!-- Game JavaScript -->
    <script>
      class SimonGame {
        constructor() {
          this.sequence = [];
          this.playerSequence = [];
          this.level = 1;
          this.score = 0;
          this.highScore =
            parseInt(localStorage.getItem("simonHighScore")) || 0;
          this.isPlaying = false;
          this.isPlayerTurn = false;
          this.soundEnabled = true;
          this.speed = 1;
          this.colors = ["yellow", "red", "green", "purple"];

          this.audioContext = null;
          this.initAudio();
          this.initElements();
          this.attachEventListeners();
          this.updateHighScoreDisplay();
        }

        initAudio() {
          try {
            this.audioContext = new (window.AudioContext ||
              window.webkitAudioContext)();
          } catch (e) {
            console.log("Web Audio API not supported");
          }
        }

        playSound(frequency, duration) {
          if (!this.soundEnabled || !this.audioContext) return;

          const oscillator = this.audioContext.createOscillator();
          const gainNode = this.audioContext.createGain();

          oscillator.connect(gainNode);
          gainNode.connect(this.audioContext.destination);

          oscillator.frequency.value = frequency;
          oscillator.type = "sine";

          gainNode.gain.setValueAtTime(0.3, this.audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(
            0.01,
            this.audioContext.currentTime + duration
          );

          oscillator.start(this.audioContext.currentTime);
          oscillator.stop(this.audioContext.currentTime + duration);
        }

        initElements() {
          this.welcomeScreen = document.getElementById("welcomeScreen");
          this.gameScreen = document.getElementById("gameScreen");
          this.startButton = document.getElementById("startButton");
          this.quitButton = document.getElementById("quitButton");
          this.soundToggle = document.getElementById("soundToggle");
          this.gameButtons = document.querySelectorAll(".game-button");
          this.statusMessage = document.getElementById("statusMessage");
          this.levelDisplay = document.getElementById("levelDisplay");
          this.scoreDisplay = document.getElementById("scoreDisplay");
          this.speedDisplay = document.getElementById("speedDisplay");
          this.gameOverModal = new bootstrap.Modal(
            document.getElementById("gameOverModal")
          );
          this.playAgainButton = document.getElementById("playAgainButton");
        }

        attachEventListeners() {
          this.startButton.addEventListener("click", () => this.startGame());
          this.quitButton.addEventListener("click", () => this.quitGame());
          this.playAgainButton.addEventListener("click", () => {
            this.gameOverModal.hide();
            this.startGame();
          });

          this.gameButtons.forEach((button) => {
            button.addEventListener("click", () =>
              this.handleButtonClick(button)
            );
          });

          this.soundToggle.addEventListener("click", () => this.toggleSound());

          document.addEventListener("keypress", (e) => {
            if (
              !this.isPlaying &&
              this.welcomeScreen.classList.contains("d-none") === false
            ) {
              this.startGame();
            }
          });
        }

        toggleSound() {
          this.soundEnabled = !this.soundEnabled;
          document.getElementById("soundIcon").textContent = this.soundEnabled
            ? "üîä"
            : "üîá";
        }

        startGame() {
          this.sequence = [];
          this.playerSequence = [];
          this.level = 1;
          this.score = 0;
          this.speed = 1;
          this.isPlaying = true;

          this.welcomeScreen.classList.add("d-none");
          this.gameScreen.classList.remove("d-none");
          this.gameScreen.classList.add("fade-in");

          this.updateDisplay();
          setTimeout(() => this.nextRound(), 500);
        }

        nextRound() {
          this.playerSequence = [];
          this.isPlayerTurn = false;
          this.disableButtons();

          const randomColor =
            this.colors[Math.floor(Math.random() * this.colors.length)];
          this.sequence.push(randomColor);

          this.statusMessage.textContent = `Level ${this.level} - Watch carefully...`;

          setTimeout(() => this.playSequence(), 1000);
        }

        async playSequence() {
          const baseDelay = Math.max(400 - this.level * 10, 200);

          for (let i = 0; i < this.sequence.length; i++) {
            await this.delay(baseDelay);
            await this.flashButton(this.sequence[i], true);
          }

          this.isPlayerTurn = true;
          this.enableButtons();
          this.statusMessage.textContent = "Your turn! Repeat the pattern";
        }

        async flashButton(color, playAudio = false) {
          const button = document.querySelector(`[data-color="${color}"]`);
          button.classList.add("flash");

          if (playAudio) {
            const frequencies = {
              yellow: 329.63,
              red: 261.63,
              green: 392.0,
              purple: 493.88,
            };
            this.playSound(frequencies[color], 0.3);
          }

          await this.delay(300);
          button.classList.remove("flash");
        }

        handleButtonClick(button) {
          if (!this.isPlayerTurn || !this.isPlaying) return;

          const color = button.dataset.color;
          this.playerSequence.push(color);

          this.flashButton(color, true);

          const currentIndex = this.playerSequence.length - 1;

          if (
            this.playerSequence[currentIndex] !== this.sequence[currentIndex]
          ) {
            this.gameOver(false);
            return;
          }

          if (this.playerSequence.length === this.sequence.length) {
            this.isPlayerTurn = false;
            this.disableButtons();
            this.levelUp();
          }
        }

        levelUp() {
          this.level++;
          this.score += this.level * 10;
          this.speed = 1 + this.level / 10;

          this.updateDisplay();
          this.statusMessage.textContent = "üéâ Correct! Get ready...";

          setTimeout(() => this.nextRound(), 1500);
        }

        gameOver(isWin = false) {
          this.isPlaying = false;
          this.disableButtons();

          const gameCard = document.querySelector(".game-card");
          gameCard.classList.add("game-over-shake");
          setTimeout(() => gameCard.classList.remove("game-over-shake"), 500);

          if (this.score > this.highScore) {
            this.highScore = this.score;
            localStorage.setItem("simonHighScore", this.highScore);
            document.getElementById("gameOverEmoji").textContent = "üèÜ";
            document.getElementById("gameOverTitle").textContent =
              "New High Score!";
          } else {
            document.getElementById("gameOverEmoji").textContent = "üò¢";
            document.getElementById("gameOverTitle").textContent = "Game Over!";
          }

          document.getElementById("finalLevel").textContent = this.level;
          document.getElementById("finalScore").textContent = this.score;
          document.getElementById("modalHighScore").textContent =
            this.highScore;

          setTimeout(() => this.gameOverModal.show(), 500);
        }

        quitGame() {
          this.isPlaying = false;
          this.gameScreen.classList.add("d-none");
          this.welcomeScreen.classList.remove("d-none");
          this.updateHighScoreDisplay();
        }

        disableButtons() {
          this.gameButtons.forEach((btn) => btn.classList.add("disabled"));
        }

        enableButtons() {
          this.gameButtons.forEach((btn) => btn.classList.remove("disabled"));
        }

        updateDisplay() {
          this.levelDisplay.textContent = this.level;
          this.scoreDisplay.textContent = this.score;
          document.getElementById("gameHighScore").textContent = this.highScore;
          this.speedDisplay.textContent = `${this.speed.toFixed(1)}x`;
        }

        updateHighScoreDisplay() {
          document.getElementById("highScoreDisplay").textContent =
            this.highScore;
        }

        delay(ms) {
          return new Promise((resolve) => setTimeout(resolve, ms));
        }
      }

      // Initialize game when DOM is loaded
      document.addEventListener("DOMContentLoaded", () => {
        new SimonGame();
      });
    </script>
  </body>
</html>
